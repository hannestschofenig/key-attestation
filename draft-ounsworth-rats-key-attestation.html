<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Key Attestation</title>
<meta content="Mike Ounsworth" name="author">
<meta content="Henk Birkholz" name="author">
<meta content="Thomas Fossati" name="author">
<meta content="Monty Wiseman" name="author">
<meta content="Hannes Tschofenig" name="author">
<meta content="
       This document specifies a format for key attestation claims to provide evidence of the security properties of
trusted execution environments and secure elements in which private keys may be generated and stored. This evidence is intended
to be used by a Relying Party, such as a Certification Authority (CA), as part of validating an incoming
certificate signing request (CSR). The specification defines key claims using ASN.1 and CDDL. 
    " name="description">
<meta content="xml2rfc 3.25.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ounsworth-rats-key-attestation-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.25.0
    Python 3.12.7
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-ounsworth-rats-key-attestation.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Key Attestation</td>
<td class="right">December 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Ounsworth, et al.</td>
<td class="center">Expires 18 June 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Remote ATtestation ProcedureS</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ounsworth-rats-key-attestation-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-12-15" class="published">15 December 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-06-18">18 June 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Ounsworth</div>
<div class="org">Entrust</div>
</div>
<div class="author">
      <div class="author-name">H. Birkholz</div>
<div class="org">Fraunhofer SIT</div>
</div>
<div class="author">
      <div class="author-name">T. Fossati</div>
<div class="org">Linaro</div>
</div>
<div class="author">
      <div class="author-name">M. Wiseman</div>
<div class="org">Beyond Identity</div>
</div>
<div class="author">
      <div class="author-name">H. Tschofenig</div>
<div class="org">H-BRS</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Key Attestation</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a format for key attestation claims to provide evidence of the security properties of
trusted execution environments and secure elements in which private keys may be generated and stored. This evidence is intended
to be used by a Relying Party, such as a Certification Authority (CA), as part of validating an incoming
certificate signing request (CSR). The specification defines key claims using ASN.1 and CDDL.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    Remote ATtestation ProcedureS Working Group mailing list (rats@ietf.org),
    which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/rats/">https://mailarchive.ietf.org/arch/browse/rats/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/hannestschofenig/key-attestation">https://github.com/hannestschofenig/key-attestation</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 18 June 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-architecture" class="internal xref">Architecture</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-information-model" class="internal xref">Information Model</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-data-model" class="internal xref">Data Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-key-claims-for-asn1" class="internal xref">Key Claims for ASN.1</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-key-claims-for-eat" class="internal xref">Key Claims for EAT</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-key-claims-for-asn1-2" class="internal xref">Key Claims for ASN.1</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-key-claims-for-eat-2" class="internal xref">Key Claims for EAT</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">When a PKI End Entity provides a Certificate Signing Request (CSR) in requesting a certificate from a Certification Authority (CA),
that entity may wish to provide evidence of the security properties of the hardware security module where
the private key resides. This evidence is verified by a Relying Party, such as a CA, as part of the CSR
validation against a given certificate policy. [<span>[<a href="#I-D.ietf-lamps-csr-attestation" class="cite xref">I-D.ietf-lamps-csr-attestation</a>]</span>] specifies how to carry
evidence within PKCS#10 [<span>[<a href="#RFC2986" class="cite xref">RFC2986</a>]</span>] or Certificate Request Message Format (CRMF) [<span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span>].<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The content and encoding of this evidence in a CSR are not constrained by [<span>[<a href="#I-D.ietf-lamps-csr-attestation" class="cite xref">I-D.ietf-lamps-csr-attestation</a>]</span>].
Hence, it is possible to use the Entity Attestation Token (EAT) <span>[<a href="#I-D.ietf-rats-eat" class="cite xref">I-D.ietf-rats-eat</a>]</span> or, when a DER-based
encoding of claims is desired, <span>[<a href="#I-D.ietf-rats-pkix-evidence" class="cite xref">I-D.ietf-rats-pkix-evidence</a>]</span>. For the latter, ASN.1 <span>[<a href="#X.680" class="cite xref">X.680</a>]</span><span>[<a href="#RFC5912" class="cite xref">RFC5912</a>]</span> is used
to describe the claims, and for EATs the claims are defined in CDDL.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This specification defines the architecture for performing key attestation and registers claims for use with <span>[<a href="#I-D.ietf-rats-eat" class="cite xref">I-D.ietf-rats-eat</a>]</span>
and <span>[<a href="#I-D.ietf-rats-pkix-evidence" class="cite xref">I-D.ietf-rats-pkix-evidence</a>]</span>.<a href="#section-1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The following terms are used in this document:<a href="#section-2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2-2">
        <dt id="section-2-2.1">Root of Trust (RoT):</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.2">
          <p id="section-2-2.2.1">A set of software and/or hardware components that need to be trusted
to act as a security foundation required for accomplishing the security
goals of a system. In our case, the RoT is expected to offer the
functionality for attesting to the state of the platform, and to attest
the properties of the identity key (IK). More precisely, it has to atttest
the integrity of the IK (public as well as private key) and the
confidentiality of the IK private key.<a href="#section-2-2.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.3">Attestation Key (AK):</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.4">
          <p id="section-2-2.4.1">Cryptographic key belonging to the RoT that is only used to sign
attestation tokens.<a href="#section-2-2.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.5">Platform Attestation Key (PAK):</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.6">
          <p id="section-2-2.6.1">An AK used specifically for signing attestation tokens relating to the
state of the platform.<a href="#section-2-2.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.7">Key Attestation:</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.8">
          <p id="section-2-2.8.1">Evidence containing properties of the environment(s) in which the private
keys are generated and stored. For example, a Relying Party may want to know whether
a private key is stored in a hardware security module and cannot be
exported in cleartext.<a href="#section-2-2.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.9">Key Attestation Key (KAK):</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.10">
          <p id="section-2-2.10.1">An AK used specifically for signing KATs. In some systems only a
single AK is used. In that case the AK is used as a PAK and a KAK.<a href="#section-2-2.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.11">Identity Key (IK):</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.12">
          <p id="section-2-2.12.1">The IK consists of a private and a public key. The private key is used
by the usage protocol. The public key is included in the Key Attestation
Token.  The IK is protected by the RoT.<a href="#section-2-2.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.13">Usage Protocol:</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.14">
          <p id="section-2-2.14.1">A (security) protocol that requires demonstrating possession of the
private component of the IK.<a href="#section-2-2.14.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.15">Attestation Token (AT):</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.16">
          <p id="section-2-2.16.1">A collection of claims that a RoT assembles (and signs) with the
purpose of informing - in a verifiable way - relying parties about the
identity and state of the platform. Essentially a type of Evidence as
per the RATS architecture terminology <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.<a href="#section-2-2.16.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.17">Platform Attestation Token (PAT):</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.18">
          <p id="section-2-2.18.1">An AT containing claims relating to the security state of the
platform, including software constituting the platform trusted computing
base (TCB). The process of generating a PAT typically involves gathering
data during measured boot.<a href="#section-2-2.18.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.19">Key Attestation Token (KAT):</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.20">
          <p id="section-2-2.20.1">An AT containing a claim with a public key. The KAT
may also contain other claims, such as those indicating its validity.
The KAT is signed by the KAK. The key attestation service, which is part
of the platform root of trust (RoT), conceptually acts as a local
certification authority since the KAT behaves like a certificate.<a href="#section-2-2.20.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.21">Combined Attestation Bundle (CAB):</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.22">
          <p id="section-2-2.22.1">A structure used to bundle a KAT and a PAT together for transport in
the usage protocol. If the KAT already includes a PAT, in form of a
nested token, then it already corresponds to a CAB.  A CAB is equivalent
to a certificate that binds the identity of the platform's TCB with the
IK public key.<a href="#section-2-2.22.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.23">Presenter:</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.24">
          <p id="section-2-2.24.1">Party that proves possession of a private key to a recipient of a KAT.<a href="#section-2-2.24.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.25">Recipient:</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.26">
          <p id="section-2-2.26.1">Party that receives the KAT containing the proof-of-possession key
information from the presenter.<a href="#section-2-2.26.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.27">Key Attestation Service (KAS):</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.28">
          <p id="section-2-2.28.1">The issuer that creates the KAT and bundles a KAT together with a PAT
in a CAB.<a href="#section-2-2.28.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-3">The reader is assumed to be familiar with the vocabulary and concepts
defined in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="architecture">
<section id="section-3">
      <h2 id="name-architecture">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-architecture" class="section-name selfRef">Architecture</a>
      </h2>
<p id="section-3-1">Key attestation is an extension to the attestation functionality
described in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.  We describe this conceptually by splitting
the internals of the attester into two parts, platform attestation and
key attestation. This split is shown in <a href="#fig-arch" class="auto internal xref">Figure 1</a>. These are logical roles
and implementations may combine them into a single physical entity.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Security-sensitive functionality, like attestation, has to be placed
into the Root of Trust (RoT). Since the RoT itself
may be comprised of different components, the design allows platform
attestation to be separated from key attestation whereby platform
attestation is more privileged than the key attestation code.
Cryptographic services, used by key attestation and by platform
attestation, are typically part of separate components within the RoT
but they are not shown in the figure.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The protocol used for communication between the Presenter and the
Recipient is referred as the Usage Protocol. The Usage Protocol, which is
outside the scope of this specification, needs to support
proof-of-possession of the private key (explained further below).
Examples of usage protocols are attested TLS <span>[<a href="#I-D.fossati-tls-attestation" class="cite xref">I-D.fossati-tls-attestation</a>]</span>
or attested CSR <span>[<a href="#I-D.ietf-lamps-csr-attestation" class="cite xref">I-D.ietf-lamps-csr-attestation</a>]</span>.<a href="#section-3-3" class="pilcrow">¶</a></p>
<span id="name-architecture-2"></span><div id="fig-arch">
<figure id="figure-1">
        <div id="section-3-4.1">
          <div class="alignLeft art-svg artwork" id="section-3-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="368" width="448" viewBox="0 0 448 368" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,48 L 8,192" fill="none" stroke="black"></path>
              <path d="M 8,272 L 8,336" fill="none" stroke="black"></path>
              <path d="M 24,48 L 24,160" fill="none" stroke="black"></path>
              <path d="M 40,80 L 40,144" fill="none" stroke="black"></path>
              <path d="M 72,168 L 72,264" fill="none" stroke="black"></path>
              <path d="M 152,80 L 152,144" fill="none" stroke="black"></path>
              <path d="M 152,272 L 152,336" fill="none" stroke="black"></path>
              <path d="M 176,80 L 176,144" fill="none" stroke="black"></path>
              <path d="M 288,80 L 288,144" fill="none" stroke="black"></path>
              <path d="M 296,272 L 296,336" fill="none" stroke="black"></path>
              <path d="M 304,48 L 304,160" fill="none" stroke="black"></path>
              <path d="M 320,48 L 320,192" fill="none" stroke="black"></path>
              <path d="M 440,272 L 440,336" fill="none" stroke="black"></path>
              <path d="M 24,32 L 304,32" fill="none" stroke="black"></path>
              <path d="M 24,48 L 304,48" fill="none" stroke="black"></path>
              <path d="M 40,80 L 152,80" fill="none" stroke="black"></path>
              <path d="M 176,80 L 288,80" fill="none" stroke="black"></path>
              <path d="M 40,144 L 152,144" fill="none" stroke="black"></path>
              <path d="M 176,144 L 288,144" fill="none" stroke="black"></path>
              <path d="M 24,160 L 304,160" fill="none" stroke="black"></path>
              <path d="M 24,208 L 304,208" fill="none" stroke="black"></path>
              <path d="M 8,272 L 152,272" fill="none" stroke="black"></path>
              <path d="M 296,272 L 440,272" fill="none" stroke="black"></path>
              <path d="M 152,304 L 288,304" fill="none" stroke="black"></path>
              <path d="M 8,336 L 152,336" fill="none" stroke="black"></path>
              <path d="M 296,336 L 440,336" fill="none" stroke="black"></path>
              <path d="M 24,32 C 15.16936,32 8,39.16936 8,48" fill="none" stroke="black"></path>
              <path d="M 304,32 C 312.83064,32 320,39.16936 320,48" fill="none" stroke="black"></path>
              <path d="M 24,208 C 15.16936,208 8,200.83064 8,192" fill="none" stroke="black"></path>
              <path d="M 304,208 C 312.83064,208 320,200.83064 320,192" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="296,304 284,298.4 284,309.6" fill="black" transform="rotate(0,288,304)"></polygon>
              <polygon class="arrowhead" points="80,264 68,258.4 68,269.6" fill="black" transform="rotate(90,72,264)"></polygon>
              <polygon class="arrowhead" points="80,168 68,162.4 68,173.6" fill="black" transform="rotate(270,72,168)"></polygon>
              <g class="text">
                <text x="68" y="68">Attester</text>
                <text x="64" y="100">Key</text>
                <text x="220" y="100">Platform</text>
                <text x="96" y="116">Attestation</text>
                <text x="232" y="116">Attestation</text>
                <text x="80" y="132">Service</text>
                <text x="216" y="132">Service</text>
                <text x="148" y="196">Root</text>
                <text x="180" y="196">of</text>
                <text x="216" y="196">Trust</text>
                <text x="264" y="196">(RoT)</text>
                <text x="184" y="292">Usage</text>
                <text x="244" y="292">Protocol</text>
                <text x="80" y="308">Presenter</text>
                <text x="368" y="308">Recipient</text>
              </g>
            </svg><a href="#section-3-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-architecture-2" class="selfRef">Architecture</a>
        </figcaption></figure>
</div>
<p id="section-3-5">The detailed implementations of key attestation may vary but the following
description aims to illustrate one possible approach. The goal of this
algorithm is to demonstrate to the recipient that the sIK (private part
of the IK) has certain security properties. Properties of interest could,
for example, be 'private key is stored in a hardware security model
manufacturered by example.com and cannot be exported in the clear.'.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">The process starts with the the Presenter triggering the generation of the IK. The IK consists of a
public key (pIK) and a private key (sIK).  The Presenter may, for
example, use the following API call to trigger the generation of the key
pair for a given algorithm and to obtain a key handle (key_id).<a href="#section-3-6" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3-7">
<pre>
key_id = GenerateKeyPair(alg_id)
</pre><a href="#section-3-7" class="pilcrow">¶</a>
</div>
<p id="section-3-8">The private key is created and stored such that it is only accessible to
the KAS rather than to other software layers at the host, such as the
TLS protocol layer i.e. the Presenter.<a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9">Next, the KAS needs to trigger the creation of the Platform Attestation
Token (PAT) by the Platform Attestation Service.  The PAT needs to be
linked to the Key Attestation Token (KAT) and this linkage can occur in
a number of ways. One approach is described in this specification in
<span>[<a href="#I-D.bft-rats-kat" class="cite xref">I-D.bft-rats-kat</a>]</span>. The Key Attestation Token (KAT) includes the public key of
the IK (pIK) and is then signed with the Key Attestation Key (KAK).<a href="#section-3-9" class="pilcrow">¶</a></p>
<p id="section-3-10">To ensure freshness of the PAT and the KAT a nonce is used, as suggested
by the RATS architecture <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>. Here is the symbolic API call
to request a KAT and a PAT, which are concatenated together as the CAB.<a href="#section-3-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3-11">
<pre>
cab = createCAB(key_id, nonce)
</pre><a href="#section-3-11" class="pilcrow">¶</a>
</div>
<p id="section-3-12">Once the CAB has been sent by the Presenter to the Recipient, the
Presenter has to demonstrate possession of the private key.  The
signature operation uses the private key of the IK (sIK).  How this
proof-of-possession of the private key is accomplished depends on the
details of the usage protocol and is outside the scope of this
specification.<a href="#section-3-12" class="pilcrow">¶</a></p>
<p id="section-3-13">The Recipient of the CAB and the proof-of-possession data (such as a
digital signature) first extracts the PAT and the KAT. The PAT and the
KAT may need to be conveyed to a Verifier. If the PAT is in the form of
attestation results the checks can be performed locally at the
Recipient, whereby the following checks are made:<a href="#section-3-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-14.1">
          <p id="section-3-14.1.1">The signature covering the PAT passes verification when using
available trust anchor(s).<a href="#section-3-14.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-14.2">
          <p id="section-3-14.2.1">The chaining of the PAT and the KAT has to be verified. The detailed
verification procedure depends on the chaining mechanism utilized.<a href="#section-3-14.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-14.3">
          <p id="section-3-14.3.1">The claims in the PAT are matched against stored reference values.<a href="#section-3-14.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-14.4">
          <p id="section-3-14.4.1">The signature protecting the KAT must pass verification.<a href="#section-3-14.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-14.5">
          <p id="section-3-14.5.1">The KAT is checked for replays.<a href="#section-3-14.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-3-15">Once all these steps are completed, the verifier produces the
attestation result and includes (if needed) the IK public key (pIK).<a href="#section-3-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="information-model">
<section id="section-4">
      <h2 id="name-information-model">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-information-model" class="section-name selfRef">Information Model</a>
      </h2>
<p id="section-4-1">This section describes the semantics of the key claims as part of the information
model.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">An initial set of key claims is defined:<a href="#section-4-2" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
        <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Claim</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">KeyId</td>
            <td class="text-left" rowspan="1" colspan="1">Identifies the subject key, with a vendor-specific format constrained to ASCII</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">PubKey</td>
            <td class="text-left" rowspan="1" colspan="1">Represents the subject public key being attested.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Purpose</td>
            <td class="text-left" rowspan="1" colspan="1">Defines the intended usage for the key.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">NonExportable</td>
            <td class="text-left" rowspan="1" colspan="1">Indicates if the key is non-exportable.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Imported</td>
            <td class="text-left" rowspan="1" colspan="1">Shows whether the key was imported.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">KeyExpiry</td>
            <td class="text-left" rowspan="1" colspan="1">Defines the expiry date or "not after" time for the key.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">FipsBoot</td>
            <td class="text-left" rowspan="1" colspan="1">Indicates whether the cryptographic module was booted in a specific FIPS state, including any required self-tests and conditions specified by its FIPS certificate.</td>
          </tr>
        </tbody>
      </table>
</section>
</div>
<div id="data-model">
<section id="section-5">
      <h2 id="name-data-model">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-data-model" class="section-name selfRef">Data Model</a>
      </h2>
<div id="key-claims-for-asn1">
<section id="section-5.1">
        <h3 id="name-key-claims-for-asn1">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-key-claims-for-asn1" class="section-name selfRef">Key Claims for ASN.1</a>
        </h3>
<p id="section-5.1-1">The following table defines key claims relevant for key attestation described
in ASN.1 for use in X.509 certificates and DER-encoded data structures.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Claim</th>
              <th class="text-left" rowspan="1" colspan="1">OID</th>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Status</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">KeyId</td>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">IA5String</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span class="bcp14">OPTIONAL</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">PubKey</td>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">OCTET STRING</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span class="bcp14">RECOMMENDED</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Purpose</td>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">CHOICE</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span class="bcp14">RECOMMENDED</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">NonExportable</td>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">BOOLEAN</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span class="bcp14">RECOMMENDED</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Imported</td>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">BOOLEAN</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span class="bcp14">RECOMMENDED</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">KeyExpiry</td>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">Time</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span class="bcp14">OPTIONAL</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">FipsBoot</td>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">BOOLEAN</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span class="bcp14">RECOMMENDED</span>
</td>
            </tr>
          </tbody>
        </table>
<div class="lang-asn.1 sourcecode" id="section-5.1-3">
<pre>
KeyId EVIDENCE-CLAIM ::= IA5String IDENTIFIED BY TBD

PubKey EVIDENCE-CLAIM ::= OCTET STRING IDENTIFIED BY TBD

Purpose EVIDENCE-CLAIM ::= CHOICE IDENTIFIED BY TBD {
   Sign, Decrypt, Unwrap, ...
}

NonExportable EVIDENCE-CLAIM ::= BOOLEAN IDENTIFIED BY TBD

Imported EVIDENCE-CLAIM ::= BOOLEAN IDENTIFIED BY TBD

KeyExpiry EVIDENCE-CLAIM ::= Time

FipsBoot EVIDENCE-CLAIM ::= BOOLEAN IDENTIFIED BY TBD
</pre><a href="#section-5.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="key-claims-for-eat">
<section id="section-6">
      <h2 id="name-key-claims-for-eat">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-key-claims-for-eat" class="section-name selfRef">Key Claims for EAT</a>
      </h2>
<p id="section-6-1">For use in the Entity Attestation Token (EAT) the claims are
described in CDDL. As a result, these claims can be encoded
in CBOR and JSON.<a href="#section-6-1" class="pilcrow">¶</a></p>
<table class="center" id="table-3">
        <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Claim Name</th>
            <th class="text-left" rowspan="1" colspan="1">Claim Key</th>
            <th class="text-left" rowspan="1" colspan="1">CBOR Type</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">key-id</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">tstr</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">pub-key</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">bstr</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">purpose</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">tstr/array</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">non-exportable</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">bool</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">imported</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">bool</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">key-expiry</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">time</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">fips-mode</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">bool</td>
          </tr>
        </tbody>
      </table>
</section>
</div>
<div id="sec-cons">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">A Verifier <span class="bcp14">MAY</span> reject an evidence claim if it lacks required information per their
appraisal policy. For example, if a Relying Party mandates a FIPS-certified device,
it <span class="bcp14">SHOULD</span> reject evidence lacking sufficient information to verify the device's FIPS
certification status.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">"FIPS Boot" alone does not guarantee "FIPS Certification". This claim should be used
alongside a valid FIPS certification.<a href="#section-7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">Please replace "RFCthis" with the RFC number assigned to this document.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="key-claims-for-asn1-1">
<section id="section-8.1">
        <h3 id="name-key-claims-for-asn1-2">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-key-claims-for-asn1-2" class="section-name selfRef">Key Claims for ASN.1</a>
        </h3>
<p id="section-8.1-1">This document requests the registration of new Object Identifiers (OIDs) for the key attestation claims defined in this
specification. The OIDs are to be registered under an appropriate OID arc managed by IANA.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">The following OIDs are requested:<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<table class="center" id="table-4">
          <caption><a href="#table-4" class="selfRef">Table 4</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Claim Name</th>
              <th class="text-left" rowspan="1" colspan="1">OID</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>key-id</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TBD.OID</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>pub-key</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TBD.OID</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>purpose</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TBD.OID</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>non-exportable</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TBD.OID</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>imported</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TBD.OID</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>key-expiry</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TBD.OID</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>fips-mode</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TBD.OID</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>vendor-info</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TBD.OID</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>nested-evidences</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TBD.OID</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
          </tbody>
        </table>
<p id="section-8.1-4">Note:<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-5.1">
            <p id="section-8.1-5.1.1">The <code>TBD.OID</code> values will be assigned by IANA during the registration process.<a href="#section-8.1-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-5.2">
            <p id="section-8.1-5.2.1">These OIDs are intended for use in ASN.1 data structures for the key attestation claims defined in this document.<a href="#section-8.1-5.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="key-claims-for-eat-1">
<section id="section-8.2">
        <h3 id="name-key-claims-for-eat-2">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-key-claims-for-eat-2" class="section-name selfRef">Key Claims for EAT</a>
        </h3>
<p id="section-8.2-1">This document requests the registration of new claims in the "EAT Claims" registry defined by <span>[<a href="#I-D.ietf-rats-eat" class="cite xref">I-D.ietf-rats-eat</a>]</span>.
These claims are specific to key attestation and are intended for use in the context of the Entity Attestation Token (EAT).<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">The following claims should be added to the registry:<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<table class="center" id="table-5">
          <caption><a href="#table-5" class="selfRef">Table 5</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Claim Name</th>
              <th class="text-left" rowspan="1" colspan="1">Claim Key</th>
              <th class="text-left" rowspan="1" colspan="1">CBOR Type</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>key-id</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">tstr</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>pub-key</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">bstr</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>purpose</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">tstr/array</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>non-exportable</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">bool</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>imported</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">bool</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>key-expiry</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">time</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>fips-mode</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">bool</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
          </tbody>
        </table>
<p id="section-8.2-4">Note:<a href="#section-8.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-5.1">
            <p id="section-8.2-5.1.1">The exact "Claim Key" values (TBD) will be assigned by IANA during the registration process.<a href="#section-8.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.2-5.2">
            <p id="section-8.2-5.2.1">The CBOR types are defined as per <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>, with appropriate encoding rules for each claim.<a href="#section-8.2-5.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-rats-eat">[I-D.ietf-rats-eat]</dt>
        <dd>
<span class="refAuthor">Lundblade, L.</span>, <span class="refAuthor">Mandyam, G.</span>, <span class="refAuthor">O'Donoghue, J.</span>, and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"The Entity Attestation Token (EAT)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-eat-31</span>, <time datetime="2024-09-06" class="refDate">6 September 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-31">https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-31</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9334">[RFC9334]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote ATtestation procedureS (RATS) Architecture"</span>, <span class="seriesInfo">RFC 9334</span>, <span class="seriesInfo">DOI 10.17487/RFC9334</span>, <time datetime="2023-01" class="refDate">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9334">https://www.rfc-editor.org/rfc/rfc9334</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.680">[X.680]</dt>
      <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology -- Abstract Syntax Notation One (ASN.1): Specification of basic notation"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.itu.int/rec/T-REC-X.680">https://www.itu.int/rec/T-REC-X.680</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.bft-rats-kat">[I-D.bft-rats-kat]</dt>
        <dd>
<span class="refAuthor">Brossard, M.</span>, <span class="refAuthor">Fossati, T.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">H. Birkholz</span>, <span class="refTitle">"An EAT-based Key Attestation Token"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-bft-rats-kat-05</span>, <time datetime="2024-11-21" class="refDate">21 November 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-bft-rats-kat-05">https://datatracker.ietf.org/doc/html/draft-bft-rats-kat-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.fossati-tls-attestation">[I-D.fossati-tls-attestation]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Howard, P.</span>, <span class="refAuthor">Mihalcea, I.</span>, <span class="refAuthor">Deshpande, Y.</span>, <span class="refAuthor">Niemi, A.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Using Attestation in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-fossati-tls-attestation-08</span>, <time datetime="2024-10-21" class="refDate">21 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-fossati-tls-attestation-08">https://datatracker.ietf.org/doc/html/draft-fossati-tls-attestation-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-csr-attestation">[I-D.ietf-lamps-csr-attestation]</dt>
        <dd>
<span class="refAuthor">Ounsworth, M.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Wiseman, M.</span>, and <span class="refAuthor">N. Smith</span>, <span class="refTitle">"Use of Remote Attestation with Certification Signing Requests"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-csr-attestation-14</span>, <time datetime="2024-10-21" class="refDate">21 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-csr-attestation-14">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-csr-attestation-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-pkix-evidence">[I-D.ietf-rats-pkix-evidence]</dt>
        <dd>
<span class="refAuthor">Ounsworth, M.</span>, <span class="refAuthor">Kettlewell, R.</span>, <span class="refAuthor">Fiset, J.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Reddy.K, T.</span>, and <span class="refAuthor">M. Wiseman</span>, <span class="refTitle">"PKI-based Attestation Evidence"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-pkix-evidence-00</span>, <time datetime="2024-10-11" class="refDate">11 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-pkix-evidence-00">https://datatracker.ietf.org/doc/html/draft-ietf-rats-pkix-evidence-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2986">[RFC2986]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #10: Certification Request Syntax Specification Version 1.7"</span>, <span class="seriesInfo">RFC 2986</span>, <span class="seriesInfo">DOI 10.17487/RFC2986</span>, <time datetime="2000-11" class="refDate">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2986">https://www.rfc-editor.org/rfc/rfc2986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4211">[RFC4211]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Request Message Format (CRMF)"</span>, <span class="seriesInfo">RFC 4211</span>, <span class="seriesInfo">DOI 10.17487/RFC4211</span>, <time datetime="2005-09" class="refDate">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4211">https://www.rfc-editor.org/rfc/rfc4211</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5912">[RFC5912]</dt>
      <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">J. Schaad</span>, <span class="refTitle">"New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)"</span>, <span class="seriesInfo">RFC 5912</span>, <span class="seriesInfo">DOI 10.17487/RFC5912</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5912">https://www.rfc-editor.org/rfc/rfc5912</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">This specification is the work of a design team created by the chairs
of the LAMPS working group. This specification has been developed
based on discussions in that design team.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mike Ounsworth</span></div>
<div dir="auto" class="left"><span class="org">Entrust Limited</span></div>
<div dir="auto" class="left"><span class="street-address">2500 Solandt Road – Suite 100</span></div>
<div dir="auto" class="left">
<span class="locality">Ottawa, Ontario</span>  <span class="postal-code">K2K 3G5</span>
</div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mike.ounsworth@entrust.com" class="email">mike.ounsworth@entrust.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Henk Birkholz</span></div>
<div dir="auto" class="left"><span class="org">Fraunhofer SIT</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:henk.birkholz@ietf.contact" class="email">henk.birkholz@ietf.contact</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Thomas Fossati</span></div>
<div dir="auto" class="left"><span class="org">Linaro</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:thomas.fossati@linaro.org" class="email">thomas.fossati@linaro.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Monty Wiseman</span></div>
<div dir="auto" class="left"><span class="org">Beyond Identity</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:monty.wiseman@beyondidentity.com" class="email">monty.wiseman@beyondidentity.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hannes Tschofenig</span></div>
<div dir="auto" class="left"><span class="org">University of Applied Sciences Bonn-Rhein-Sieg</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Hannes.Tschofenig@gmx.net" class="email">Hannes.Tschofenig@gmx.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
